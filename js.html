<script>
    function crearTablaContactos()
    {
        google.script.run
        .withSuccessHandler(crearTablacontactoCorrectamente)
        .withFailureHandler(crearTablaContactoError)
        .obtenerContactos();
        }
        
    function crearTablacontactoCorrectamente(obj){
            
        let tabla =document.getElementById('tablaContacto');
        if(tabla) tabla.remove();
        
        tabla = document.createElement('table');
        tabla.id='tablaContacto';
        let tablaHeader = document.createElement('thead');
        let tablabody = document.createElement('tbody');
        
        //header de la Tabla
        let primerafila = document.createElement('tr');
        for(let i=0;i<obj[0].length;i++){
            let celda = document.createElement('td');
            celda.textContent=obj[0][i];
            primerafila.appendChild(celda);
        } 
        tablaHeader.appendChild(primerafila);
        tabla.appendChild(tablaHeader);

        // Body de la tabla
        for(let i=1; i< obj.length; i++){
            let fila =document.createElement('tr');
            for(let j=0;j<obj[i].length;j++){
                let celda = document.createElement('td');
                celda.textContent=obj[i][j];
                fila.appendChild(celda);
            }   
            tablabody.appendChild(fila);
        }    
        // Clases a la Cabecera
        tablaHeader.classList.add('table-dark')
        // agregamos el cuerpo a la tabla
        tabla.appendChild(tablabody);
        // agregamos classes a la tabla
        tabla.classList.add('table','table-striped','border','border-3');
        // agregamos tabla a la pagina
        document.getElementById('divContactos').appendChild(tabla);
        
        // Notificacion de OK
        crearNotificacion(1,'Contactos obtenidos correctamente','Todo en orden')
    }

    function crearTablaContactoError(){
    // Mostrar Notificacion de Error

    }

    function crearNotificacion(tipo,mensaje,titulo){
        // obtener los datos
        let mensajeNotificacion     = document.getElementById('mensajeNotificacion');
        let tituloNotificacion      = document.getElementById('tituloNotificacion');
        let elementoNotificacion    = document.getElementById('notificacion');
        let iconoNotificacion       = document.getElementById('iconoNotificacion');
        let notificacion            = bootstrap.Toast.getOrCreateInstance(elementoNotificacion ); 

        // Editar la notificacion

        iconoNotificacion.className='';
        iconoNotificacion.classList.add('bi', 'bi-check2-square');
        mensajeNotificacion.textContent = mensaje;
        tituloNotificacion.textContent = titulo;
        elementoNotificacion.style.backgroundColor=getComputedStyle(document.documentElement).getPropertyValue('--color-verde-oscuro');


        // Mostrar Notificacion

        notificacion.show()


    }

</script>